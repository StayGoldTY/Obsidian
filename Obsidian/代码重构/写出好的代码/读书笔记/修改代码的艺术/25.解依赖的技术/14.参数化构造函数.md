**25.14**  **参数化构造函数**

如果你用构造函数创建了一个对象，那么通常解除对该对象的依赖的最佳办法就是将它的创建过程外部化，即在该类外创建该对象，然后让该类的客户代码将这个对象传给该类的构造函数。 下面就是一个例子。

一开始的代码如下所示：
![[Pasted image 20240524160931.png]]这么一来你就既保证了测试代码能够换入必要的测试用对象，又丝毫不干扰产品代码。 让我们一步一步来，下面是原始代码：
![[Pasted image 20240524161043.png]]![[Pasted image 20240524161054.png]]现在，转到另一个构造函数，删除其函数体，代以对刚才那个构造函数的调用。别忘了，调 用的时候new 一个MailReceiver 对象出来传给它。
![[Pasted image 20240524161142.png]]该技术有什么缺点吗?有的。当我们往一个构造函数上添加一个新的参数时，可能会导致进 一步对该参数的类型的依赖。该类的用户可能会在产品代码中使用这个新的构造函数，从而增加 系统内的依赖。不过一般来说这个问题不要紧。参数化构造函数 (Parameterize    Constructor) 是 个非常简单的重构手法，我喜欢用它。
![[Pasted image 20240524161220.png]]
**步** **骤
参数化构造函数的步骤如下：
(1)找出你想要参数化的构造函数，并将它复制一份。
(2)给其中的一份复制增加一个参数，该参数用来传入你想要替换的对象。将该构造函数体 中的相应的对象创建语句删掉，改为使用新增的那个参数(如果需要赋值的话就将那个参数赋给 相应的实例变量)。
(3)如果你的语言支持委托构造函数',那么删掉另一份构造函数的函数体，代以对刚才那个 构造函数的调用，别忘了调用的时候要new一个相应对象出来。如果你的语言不支持委托构造函数，则可能需要将构造函数中的共同成分提取到一个比如叫common_init 的方法中。