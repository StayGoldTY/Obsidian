第一次编写单元测试时你可能会觉得有点别扭。人们通常会有的一个感觉就是觉得自己编写 的测试老是碍手碍脚的。他们在浏览项目的过程中有时会忘记到底是在看测试代码还是产品代码。随着他们的项目开始含有大量的测试代码，情况也未见好转。所以除非你着手建立一些约定 惯例，否则可能会陷入麻烦当中。

**18.1**  **类命名约定**

第一个要建立的就是类命名约定。 一般来说你至少要为某类编写一个相应的单元测试类，因 此， 一个有意义的做法就是从目标类的类名衍生出其单元测试类的类名。具体的办法一般有好几 种，其中最常用的就是往类名前加一个“Test”前缀或后缀，比如我们有一个名叫DBEngine 的类， 就可以把它的测试类叫做TestDBEngine     或DBEngineTest 。  至于是前缀还是后缀倒没多大关 系。不过我个人倒是比较喜欢后缀的写法。因为如果你的IDE 能够按字母顺序列出所有类的话，  使用后缀写法就能够让每个类后面紧跟测试类，从而方便浏览。

那么,还有哪些其他类会在测试中出现呢?伪类'。在测试中有时需要去伪造一个类的协作 类 (collaborator,即与它交互的那些类),这时一个有用的做法就是把这些伪类放在一个包或目 录中。对于这类情况我的惯例是使用前缀 “Fake” 。 这样浏览的时候就会发现它们按照字母顺序 排在了一起，同时离包中的主要类也有一定距离。这是个方便的法子，因为通常伪类是其他目录中的类的子类。

另外还有一种类也经常被用在测试中，那就是测试子类 (testing    subclass)。如果你想要测试 某个类，然而该类上却有一些依赖是需要分离出来的，那么可能就需要为它写一个所谓的“测试

 子类”。这便是测试子类的由来。在使用子类化并重写方法(317页)技术时所编写的子类就是测试子类。我给测试子类的命名习惯是在原类名前加上 “Testing”   前缀。这样如果一个包或目录中

比如我们有一个账目管理系统，把它里面的一个包内的类列出来就像这样：
![[Pasted image 20240523141906.png]]
我们看到，在上面的列表中，每个产品类后面都紧跟着它的测试类。所有伪类和测试子类也 都分别聚在一起。

我并不是说这种安排名字的方式就是唯一正确的。它在许多情况下的确有用，但同样也有许 多原因和情况变更要求我们对它作些改动。总之，符合人的习惯，让人感到舒适，这一点非常重 要。如何才能更容易地在测试类和产品类之间来回跳转，是一个重要的考虑。

**18.2**  **测试代码放在哪儿**

到目前为止我都是假设你会将测试代码和产品代码放在同一目录中，本章前面所讲的内容就 是建立在这一假设基础上的。 一般来说这种做法的确是组织一个项目的最简易办法，然而在决定 是否这么干的时候，肯定还是有另外一些东西是你需要考虑的。

比如其中一个主要的考虑就是你的应用在部署的时候有没有大小限制。当然， 一个运行在由 你管理的服务器上的应用或许并没有多少约束。如果你可以在部署的过程中说要两倍空间就要两  倍空间的话(产品代码及其测试的二进制文件),简单的做法就是把代码和测试放在同一目录下， 并部署所有的二进制文件。

否则，如果你的软件是一个商业软件，并且运行在其他人的机器上，那么部署时的大小就需 要加以考虑了。你可以试着把测试代码跟产品代码分开，但别忘了考虑一下这样做会给自己浏览 代码带来什么影响。

有时候不会有什么影响，就像这个例子那样。在Java中， 一个包可以横跨两个不同的目录。

![[Pasted image 20240523141949.png]]
即使我们把产品类放在source   下的dailyorders目录下，把测试类放在test   下的dailyorders目 录下，它们仍可以位于同一个包中。实际上有些IDE就会把来自这两个不同目录内的类放在同一 视图中，好让你无需去关心这些类的物理位置。

而在许多其他的语言和环境中，物理地点则是一个需要考虑的因素。如果你需要在目录结构里面上下移动才能够往来于代码与测试之间的话，就好像工作的时候还得拖着个沙包。结果你会 放弃编写测试，于是工作又会变得更缓慢。

一个办法是将产品代码和测试代码放在同一地点，通过构建(build)设定或脚本来阻止测试 代码参加部署。如果你的类采用了良好的命名约定的话，这个法子就是可行的。

如果你选择将测试和产品代码分离开来，那么请确保你有充分的理由这么做，因为有些团队 常常会为了“漂亮”而把它们分离开，他们觉得让测试代码跟产品代码待在一起是没法接受的。

  结果后来在浏览项目的时候就会发现麻烦了。实际上把测试代码跟产品代码放在一起也没那么 229  “丑陋”,一段时间之后你就习以为常了。